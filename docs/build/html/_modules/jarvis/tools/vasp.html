
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>jarvis.tools.vasp &#8212; jarvis-tools v2018.10.22 documentation</title>
    <link rel="stylesheet" href="../../../_static/sphinxdoc.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">jarvis-tools v2018.10.22 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for jarvis.tools.vasp</h1><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">pymatgen.symmetry.analyzer</span> <span class="k">import</span> <span class="n">SpacegroupAnalyzer</span>
<span class="kn">from</span> <span class="nn">pymatgen.electronic_structure.core</span> <span class="k">import</span> <span class="n">Spin</span><span class="p">,</span> <span class="n">OrbitalType</span>
<span class="kn">from</span> <span class="nn">pymatgen.io.vasp.outputs</span> <span class="k">import</span> <span class="n">Oszicar</span><span class="p">,</span><span class="n">Outcar</span><span class="p">,</span><span class="n">Vasprun</span>
<span class="kn">from</span> <span class="nn">pymatgen.util.plotting_utils</span> <span class="k">import</span> <span class="n">get_publication_quality_plot</span>
<span class="kn">import</span> <span class="nn">matplotlib</span><span class="o">,</span><span class="nn">yaml</span><span class="o">,</span><span class="nn">os</span>
<span class="kn">from</span> <span class="nn">pymatgen.core.periodic_table</span> <span class="k">import</span> <span class="n">Element</span>
<span class="kn">from</span> <span class="nn">pymatgen.io.vasp.inputs</span> <span class="k">import</span> <span class="n">Potcar</span><span class="p">,</span><span class="n">Incar</span><span class="p">,</span> <span class="n">Kpoints</span>
<span class="kn">from</span> <span class="nn">pymatgen.electronic_structure.plotter</span> <span class="k">import</span> <span class="n">BSPlotterProjected</span><span class="p">,</span> <span class="n">BSPlotter</span><span class="p">,</span> <span class="n">DosPlotter</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="n">matplotlib</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;Agg&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">math</span><span class="o">,</span><span class="nn">glob</span>
<span class="kn">from</span> <span class="nn">pymatgen.core.structure</span> <span class="k">import</span> <span class="n">Structure</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">pymatgen.analysis.elasticity.elastic</span> <span class="k">import</span> <span class="n">ElasticTensor</span>

<div class="viewcode-block" id="bandgap"><a class="viewcode-back" href="../../../jarvis.tools.html#jarvis.tools.vasp.bandgap">[docs]</a><span class="k">def</span> <span class="nf">bandgap</span><span class="p">(</span><span class="n">vrun</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">occu_tol</span><span class="o">=</span><span class="mf">0.001</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Parses vasprun.xml and gives bandgap </span>

<span class="sd">    Args:</span>
<span class="sd">        vrun: path to vasprun.xml </span>
<span class="sd">        occu_tol: occupation tolerance</span>
<span class="sd">    Returns:</span>
<span class="sd">           eg: bandgap</span>
<span class="sd">           direct: direct/indirect bandgap</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">v</span><span class="o">=</span><span class="n">Vasprun</span><span class="p">(</span><span class="n">vrun</span><span class="p">,</span><span class="n">occu_tol</span><span class="o">=</span><span class="n">occu_tol</span><span class="p">)</span>
    <span class="n">eg</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">v</span><span class="o">.</span><span class="n">eigenvalue_band_properties</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">direct</span><span class="o">=</span><span class="n">v</span><span class="o">.</span><span class="n">eigenvalue_band_properties</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">eg</span><span class="p">,</span><span class="n">direct</span></div>

<div class="viewcode-block" id="bandstr"><a class="viewcode-back" href="../../../jarvis.tools.html#jarvis.tools.vasp.bandstr">[docs]</a><span class="k">def</span> <span class="nf">bandstr</span><span class="p">(</span><span class="n">vrun</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">kpfile</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot electronic bandstructure</span>
<span class="sd"> </span>
<span class="sd">    Args:</span>
<span class="sd">        vrun: path to vasprun.xml</span>
<span class="sd">        kpfile:path to line mode KPOINTS file </span>
<span class="sd">    Returns:</span>
<span class="sd">           matplotlib object</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">run</span> <span class="o">=</span> <span class="n">Vasprun</span><span class="p">(</span><span class="n">vrun</span><span class="p">,</span> <span class="n">parse_projected_eigen</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="n">bands</span> <span class="o">=</span> <span class="n">run</span><span class="o">.</span><span class="n">get_band_structure</span><span class="p">(</span><span class="n">kpfile</span><span class="p">,</span> <span class="n">line_mode</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">efermi</span> <span class="o">=</span> <span class="n">run</span><span class="o">.</span><span class="n">efermi</span><span class="p">)</span>
    <span class="n">bsp</span> <span class="o">=</span>  <span class="n">BSPlotter</span><span class="p">(</span><span class="n">bands</span><span class="p">)</span>
    <span class="n">zero_to_efermi</span><span class="o">=</span><span class="kc">True</span>
    <span class="n">bandgap</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">bands</span><span class="o">.</span><span class="n">get_band_gap</span><span class="p">()[</span><span class="s1">&#39;energy&#39;</span><span class="p">],</span><span class="mi">3</span><span class="p">))</span>
    <span class="c1">#print &quot;bg=&quot;,bandgap</span>
    <span class="n">data</span><span class="o">=</span><span class="n">bsp</span><span class="o">.</span><span class="n">bs_plot_data</span><span class="p">(</span><span class="n">zero_to_efermi</span><span class="p">)</span>
    <span class="n">plt</span> <span class="o">=</span> <span class="n">get_publication_quality_plot</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
    <span class="n">band_linewidth</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="n">x_max</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;distances&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1">#print (x_max)</span>
    <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;distances&#39;</span><span class="p">])):</span>
       <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">bsp</span><span class="o">.</span><span class="n">_nb_bands</span><span class="p">):</span>
          <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;distances&#39;</span><span class="p">][</span><span class="n">d</span><span class="p">],</span>
                 <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">][</span><span class="n">d</span><span class="p">][</span><span class="s1">&#39;1&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
                  <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;distances&#39;</span><span class="p">][</span><span class="n">d</span><span class="p">]))],</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span>
                 <span class="n">linewidth</span><span class="o">=</span><span class="n">band_linewidth</span><span class="p">)</span>
          <span class="k">if</span> <span class="n">bsp</span><span class="o">.</span><span class="n">_bs</span><span class="o">.</span><span class="n">is_spin_polarized</span><span class="p">:</span>
             <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;distances&#39;</span><span class="p">][</span><span class="n">d</span><span class="p">],</span>
                     <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">][</span><span class="n">d</span><span class="p">][</span><span class="s1">&#39;-1&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
                      <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;distances&#39;</span><span class="p">][</span><span class="n">d</span><span class="p">]))],</span>
                     <span class="s1">&#39;r--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">band_linewidth</span><span class="p">)</span>
    <span class="n">bsp</span><span class="o">.</span><span class="n">_maketicks</span><span class="p">(</span><span class="n">plt</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">bsp</span><span class="o">.</span><span class="n">_bs</span><span class="o">.</span><span class="n">is_metal</span><span class="p">():</span>
         <span class="n">e_min</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10</span>
         <span class="n">e_max</span> <span class="o">=</span> <span class="mi">10</span>
         <span class="n">band_linewidth</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="k">for</span> <span class="n">cbm</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;cbm&#39;</span><span class="p">]:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">cbm</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">cbm</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span>
                        <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">vbm</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;vbm&#39;</span><span class="p">]:</span>
                <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">vbm</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vbm</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span>
                            <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathrm{Wave\ Vector}$&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
    <span class="n">ylabel</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\mathrm{E\ -\ E_f\ (eV)}$&#39;</span> <span class="k">if</span> <span class="n">zero_to_efermi</span> \
       <span class="k">else</span> <span class="sa">r</span><span class="s1">&#39;$\mathrm{Energy\ (eV)}$&#39;</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">x_max</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">plot</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
       <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="n">img_format</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">)</span>
       <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">plt</span></div>

<div class="viewcode-block" id="plot_dos"><a class="viewcode-back" href="../../../jarvis.tools.html#jarvis.tools.vasp.plot_dos">[docs]</a><span class="k">def</span> <span class="nf">plot_dos</span><span class="p">(</span><span class="n">vrun</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">low_lim</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span><span class="n">up_lim</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">extra</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot total density of states</span>

<span class="sd">    Args:</span>
<span class="sd">       vrun: vasprun.xml path</span>
<span class="sd">       low_lim: lower energy limit in eV</span>
<span class="sd">       up_lim: upper energy limit in eV</span>
<span class="sd">    Returns:</span>
<span class="sd">          matplotlib objects for</span>
<span class="sd">          total, orbital and element project density of states</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">run</span> <span class="o">=</span> <span class="n">Vasprun</span><span class="p">(</span><span class="n">vrun</span><span class="p">,</span><span class="n">occu_tol</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">)</span>
    <span class="n">complete_dos</span> <span class="o">=</span> <span class="n">run</span><span class="o">.</span><span class="n">complete_dos</span>
    <span class="n">totup</span><span class="o">=</span><span class="n">complete_dos</span><span class="o">.</span><span class="n">get_densities</span><span class="p">(</span><span class="n">spin</span><span class="o">=</span><span class="n">Spin</span><span class="o">.</span><span class="n">up</span><span class="p">)</span>
    <span class="n">totdn</span><span class="o">=</span><span class="n">complete_dos</span><span class="o">.</span><span class="n">get_densities</span><span class="p">(</span><span class="n">spin</span><span class="o">=</span><span class="n">Spin</span><span class="o">.</span><span class="n">down</span><span class="p">)</span>
    <span class="n">en</span> <span class="o">=</span> <span class="n">complete_dos</span><span class="o">.</span><span class="n">energies</span>
    <span class="n">bandgap</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">eigenvalue_band_properties</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">ef</span> <span class="o">=</span> <span class="n">complete_dos</span><span class="o">.</span><span class="n">efermi</span>
    <span class="n">en</span><span class="p">[:]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">-</span> <span class="n">ef</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">en</span><span class="p">]</span>

    <span class="n">plt1</span> <span class="o">=</span> <span class="n">get_publication_quality_plot</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="c1">#plt1.close()</span>
    <span class="c1">#plt1.clf()</span>
    <span class="n">plt1</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Energies (eV)&quot;</span><span class="p">)</span>
    <span class="n">plt1</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Tot. DOS (arb. unit.)&quot;</span><span class="p">)</span>
    <span class="n">plt1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">en</span><span class="p">,</span><span class="n">totup</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">en</span><span class="p">,</span><span class="o">-</span><span class="n">totdn</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt1</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">low_lim</span><span class="p">,</span><span class="n">up_lim</span><span class="p">)</span>
    <span class="n">plt1</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">plot</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
        <span class="n">tmp</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;/TDos&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">extra</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;.png&#39;</span><span class="p">)</span>
        <span class="n">plt1</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>

    <span class="n">spd_dos</span> <span class="o">=</span> <span class="n">complete_dos</span><span class="o">.</span><span class="n">get_spd_dos</span><span class="p">()</span>
    <span class="n">sdosup</span><span class="o">=</span><span class="n">spd_dos</span><span class="p">[</span><span class="n">OrbitalType</span><span class="o">.</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">densities</span><span class="p">[</span><span class="n">Spin</span><span class="o">.</span><span class="n">up</span><span class="p">]</span>
    <span class="n">pdosup</span><span class="o">=</span><span class="n">spd_dos</span><span class="p">[</span><span class="n">OrbitalType</span><span class="o">.</span><span class="n">p</span><span class="p">]</span><span class="o">.</span><span class="n">densities</span><span class="p">[</span><span class="n">Spin</span><span class="o">.</span><span class="n">up</span><span class="p">]</span>
    <span class="n">ddosup</span><span class="o">=</span><span class="n">spd_dos</span><span class="p">[</span><span class="n">OrbitalType</span><span class="o">.</span><span class="n">d</span><span class="p">]</span><span class="o">.</span><span class="n">densities</span><span class="p">[</span><span class="n">Spin</span><span class="o">.</span><span class="n">up</span><span class="p">]</span>
    <span class="n">sdosdn</span><span class="o">=</span><span class="n">spd_dos</span><span class="p">[</span><span class="n">OrbitalType</span><span class="o">.</span><span class="n">s</span><span class="p">]</span><span class="o">.</span><span class="n">densities</span><span class="p">[</span><span class="n">Spin</span><span class="o">.</span><span class="n">down</span><span class="p">]</span>
    <span class="n">pdosdn</span><span class="o">=</span><span class="n">spd_dos</span><span class="p">[</span><span class="n">OrbitalType</span><span class="o">.</span><span class="n">p</span><span class="p">]</span><span class="o">.</span><span class="n">densities</span><span class="p">[</span><span class="n">Spin</span><span class="o">.</span><span class="n">down</span><span class="p">]</span>
    <span class="n">ddosdn</span><span class="o">=</span><span class="n">spd_dos</span><span class="p">[</span><span class="n">OrbitalType</span><span class="o">.</span><span class="n">d</span><span class="p">]</span><span class="o">.</span><span class="n">densities</span><span class="p">[</span><span class="n">Spin</span><span class="o">.</span><span class="n">down</span><span class="p">]</span>


    <span class="n">plt2</span> <span class="o">=</span> <span class="n">get_publication_quality_plot</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="c1">#plt2.close()</span>
    <span class="c1">#plt2.clf()</span>
    <span class="n">plt2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">en</span><span class="p">,</span><span class="n">sdosup</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;s&#39;</span><span class="p">)</span>
    <span class="n">plt2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">en</span><span class="p">,</span><span class="o">-</span><span class="n">sdosdn</span><span class="p">,</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">en</span><span class="p">,</span><span class="n">pdosup</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;p&#39;</span><span class="p">)</span>
    <span class="n">plt2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">en</span><span class="p">,</span><span class="o">-</span><span class="n">pdosdn</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">en</span><span class="p">,</span><span class="n">ddosup</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;d&#39;</span><span class="p">)</span>
    <span class="n">plt2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">en</span><span class="p">,</span><span class="o">-</span><span class="n">ddosdn</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">plt2</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Energies (eV)&quot;</span><span class="p">)</span>
    <span class="n">plt2</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Orb. DOS (arb. unit.)&quot;</span><span class="p">)</span>
    <span class="n">plt2</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">26</span><span class="p">})</span>
    <span class="n">plt2</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">low_lim</span><span class="p">,</span><span class="n">up_lim</span><span class="p">)</span>
    <span class="n">plt2</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">plot</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
        <span class="n">tmp</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;/Dos&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">extra</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;.png&#39;</span><span class="p">)</span>
        <span class="n">plt2</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>

    <span class="n">plt3</span> <span class="o">=</span> <span class="n">get_publication_quality_plot</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="c1">#plt3.close()</span>
    <span class="c1">#plt3.clf()</span>
    <span class="n">elt_dos</span> <span class="o">=</span> <span class="n">complete_dos</span><span class="o">.</span><span class="n">get_element_dos</span><span class="p">()</span>
    <span class="n">at_symbs</span><span class="o">=</span><span class="nb">set</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">atomic_symbols</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">sym</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">at_symbs</span><span class="p">):</span>
        <span class="n">elt</span><span class="o">=</span><span class="n">elt_dos</span><span class="p">[</span><span class="n">Element</span><span class="p">(</span><span class="n">sym</span><span class="p">)]</span>
        <span class="c1">#color = cmap(float(i)/len(at_symbs))</span>
        <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span>
        <span class="k">elif</span> <span class="n">i</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span>
        <span class="k">elif</span> <span class="n">i</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span>
        <span class="k">elif</span> <span class="n">i</span><span class="o">==</span><span class="mi">3</span><span class="p">:</span>
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;c&#39;</span>
        <span class="k">elif</span> <span class="n">i</span><span class="o">==</span><span class="mi">4</span><span class="p">:</span>
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;m&#39;</span>
        <span class="k">elif</span> <span class="n">i</span><span class="o">==</span><span class="mi">5</span><span class="p">:</span>
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;y&#39;</span>
        <span class="k">elif</span> <span class="n">i</span><span class="o">==</span><span class="mi">6</span><span class="p">:</span>
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span>
            <span class="nb">print</span> <span class="p">(</span><span class="s2">&quot;Use different color scheme&quot;</span><span class="p">)</span>

        <span class="n">plt3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">en</span><span class="p">,</span><span class="n">elt</span><span class="o">.</span><span class="n">densities</span><span class="p">[</span><span class="n">Spin</span><span class="o">.</span><span class="n">up</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="n">sym</span><span class="p">)</span>
        <span class="n">plt3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">en</span><span class="p">,</span><span class="o">-</span><span class="n">elt</span><span class="o">.</span><span class="n">densities</span><span class="p">[</span><span class="n">Spin</span><span class="o">.</span><span class="n">down</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">plt3</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;Energies (eV)&quot;</span><span class="p">)</span>
        <span class="n">plt3</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Elm. DOS (arb. unit.)&quot;</span><span class="p">)</span>
        <span class="n">plt3</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">26</span><span class="p">})</span>
        <span class="n">plt3</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="n">low_lim</span><span class="p">,</span><span class="n">up_lim</span><span class="p">)</span>
        <span class="n">plt3</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">plot</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
        <span class="n">tmp</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;/EDos&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">extra</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;.png&#39;</span><span class="p">)</span>
        <span class="n">plt3</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">tmp</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">plt1</span><span class="p">,</span><span class="n">plt2</span><span class="p">,</span><span class="n">plt3</span></div>


<div class="viewcode-block" id="plot_enc_convergence"><a class="viewcode-back" href="../../../jarvis.tools.html#jarvis.tools.vasp.plot_enc_convergence">[docs]</a><span class="k">def</span> <span class="nf">plot_enc_convergence</span><span class="p">(</span><span class="n">directory</span><span class="o">=</span><span class="s1">&#39;../vasp/examples/SiOptb88/&#39;</span><span class="p">,</span><span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot convergence for plane-wave cut-off data</span>
<span class="sd">    Works only if jobs run through jarvis-tools framework</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">       directory: parent directory for job run</span>
<span class="sd">    Returns:</span>
<span class="sd">           matplotlib object, converged cut-off value</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">x</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">y</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;/*.json&#39;</span><span class="p">)):</span>
      <span class="k">if</span> <span class="s1">&#39;MAIN-RELAX&#39;</span> <span class="ow">in</span> <span class="n">a</span><span class="p">:</span>
         <span class="n">main_inc</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.json&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">&quot;INCAR&quot;</span><span class="p">)</span>
         <span class="n">main_inc_obj</span><span class="o">=</span><span class="n">Incar</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">main_inc</span><span class="p">)</span>
         <span class="n">convg_encut</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">main_inc_obj</span><span class="p">[</span><span class="s1">&#39;ENCUT&#39;</span><span class="p">])</span>
      <span class="k">elif</span> <span class="s1">&#39;ENCUT&#39;</span> <span class="ow">in</span> <span class="n">a</span><span class="p">:</span>
          <span class="n">run</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.json&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">&quot;vasprun.xml&quot;</span><span class="p">)</span>
          <span class="n">contcar</span><span class="o">=</span><span class="n">Structure</span><span class="o">.</span><span class="n">from_file</span><span class="p">((</span><span class="n">a</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.json&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">&quot;CONTCAR&quot;</span><span class="p">))</span>
          <span class="n">vrun</span><span class="o">=</span><span class="n">Vasprun</span><span class="p">(</span><span class="n">run</span><span class="p">)</span>
          <span class="n">infile</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.json&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">&quot;INCAR&quot;</span><span class="p">)</span>
          <span class="n">inc</span><span class="o">=</span><span class="n">Incar</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">infile</span><span class="p">)</span>
          <span class="n">encut</span><span class="o">=</span><span class="n">inc</span><span class="p">[</span><span class="s1">&#39;ENCUT&#39;</span><span class="p">]</span>
          <span class="n">en</span> <span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">vrun</span><span class="o">.</span><span class="n">final_energy</span><span class="p">)</span><span class="c1">#/float(contcar.composition.num_atoms)</span>
          <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">encut</span><span class="p">)</span>
          <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">en</span><span class="p">)</span>
    <span class="n">order</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="n">order</span><span class="p">]</span>
    <span class="n">ys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)[</span><span class="n">order</span><span class="p">]</span>
    <span class="n">plt</span> <span class="o">=</span> <span class="n">get_publication_quality_plot</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Energy (eV)&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="n">ys</span><span class="p">,</span><span class="s1">&#39;s-&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Increment in ENCUT &#39;</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">get_major_formatter</span><span class="p">()</span><span class="o">.</span><span class="n">set_useOffset</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="s2">&quot;Converged at &quot;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">convg_encut</span><span class="p">))</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">&quot;eV&quot;</span><span class="p">),</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">26</span><span class="p">)</span>
    <span class="c1">#filename=str(&#39;Encut.png&#39;)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">plot</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
       <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
       <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">plt</span><span class="p">,</span><span class="n">convg_encut</span></div>


<div class="viewcode-block" id="plot_kp_convergence"><a class="viewcode-back" href="../../../jarvis.tools.html#jarvis.tools.vasp.plot_kp_convergence">[docs]</a><span class="k">def</span> <span class="nf">plot_kp_convergence</span><span class="p">(</span><span class="n">directory</span><span class="o">=</span><span class="s1">&#39;../vasp/examples/SiOptb88/&#39;</span><span class="p">,</span><span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Plot convergence for k-points data</span>
<span class="sd">    Works only if jobs run through jarvis-tools framework</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">       directory: parent directory for job run</span>
<span class="sd">    Returns:</span>
<span class="sd">           matplotlib object, converged k-points value</span>
<span class="sd">    &quot;&quot;&quot;</span>
 
    <span class="n">x</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">y</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;/*.json&#39;</span><span class="p">)):</span>
      <span class="k">if</span> <span class="s1">&#39;MAIN-RELAX&#39;</span> <span class="ow">in</span> <span class="n">a</span><span class="p">:</span>
         <span class="n">main_kp</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.json&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">&quot;KPOINTS&quot;</span><span class="p">)</span>
         <span class="n">main_kp_obj</span><span class="o">=</span><span class="n">Kpoints</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">main_kp</span><span class="p">)</span>
         <span class="p">[</span><span class="n">k1</span><span class="p">,</span><span class="n">k2</span><span class="p">,</span><span class="n">k3</span><span class="p">]</span><span class="o">=</span><span class="n">main_kp_obj</span><span class="o">.</span><span class="n">kpts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
      <span class="k">elif</span> <span class="s1">&#39;KPOINT&#39;</span> <span class="ow">in</span> <span class="n">a</span><span class="p">:</span>
         <span class="n">k</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.json&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]))</span>
         <span class="n">run</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.json&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">&quot;vasprun.xml&quot;</span><span class="p">)</span>
         <span class="n">vrun</span><span class="o">=</span><span class="n">Vasprun</span><span class="p">(</span><span class="n">run</span><span class="p">)</span>

         <span class="n">kpfile</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">a</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.json&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">&quot;KPOINTS&quot;</span><span class="p">)</span>
         <span class="n">contcar</span><span class="o">=</span><span class="n">Structure</span><span class="o">.</span><span class="n">from_file</span><span class="p">((</span><span class="n">a</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.json&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">&quot;CONTCAR&quot;</span><span class="p">))</span>
         <span class="n">kpoints</span><span class="o">=</span><span class="n">Kpoints</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="n">kpfile</span><span class="p">)</span>
         <span class="p">[</span><span class="n">xx</span><span class="p">,</span><span class="n">yy</span><span class="p">,</span><span class="n">zz</span><span class="p">]</span><span class="o">=</span><span class="n">kpoints</span><span class="o">.</span><span class="n">kpts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
         <span class="n">en</span> <span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">vrun</span><span class="o">.</span><span class="n">final_energy</span><span class="p">)</span><span class="c1">#/float(contcar.composition.num_atoms)</span>
         <span class="c1">#en =float(vrun.final_energy)/float(contcar.composition.num_atoms)</span>
         <span class="c1"># print &quot;ENERGYYY,AT&quot;,en,float(contcar.composition.num_atoms)</span>
         <span class="n">x</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
         <span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">en</span><span class="p">)</span>



    <span class="n">order</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">x</span><span class="p">)[</span><span class="n">order</span><span class="p">]</span>
    <span class="n">ys</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)[</span><span class="n">order</span><span class="p">]</span>
    <span class="n">len_xs</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">xs</span><span class="p">)</span>
    <span class="n">xs1</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">ys1</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">target_ys</span><span class="o">=</span><span class="n">ys</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="c1">#print &quot;target=&quot;,target_ys</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">el</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">ys</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">el</span> <span class="o">&lt;=</span> <span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">target_ys</span><span class="p">)</span><span class="o">+</span><span class="mf">0.002</span><span class="p">)</span> <span class="p">:</span>
            <span class="n">xs1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">ys1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ys</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="c1">#print &quot;xs,ys=&quot;,xs,ys</span>
    <span class="c1">#print &quot;xs1,ys1=&quot;,xs1,ys1</span>
    <span class="n">left</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">,</span> <span class="mf">0.35</span><span class="p">]</span>
    <span class="n">plt</span> <span class="o">=</span> <span class="n">get_publication_quality_plot</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">ax1</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Increment in K point&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Energy (eV)&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="s2">&quot;Converged at &quot;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k1</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k2</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">k3</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">&quot;Automatic Mesh &quot;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">-</span><span class="mi">25</span><span class="p">),</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">yticks</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
    <span class="n">ax2</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">left</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">])</span>
    <span class="c1">#ax2.plot(xs1,ys1, &#39;.-&#39;,linewidth=2,markersize=10)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="n">ys</span><span class="p">,</span> <span class="s1">&#39;s-&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">el_list</span><span class="o">=</span><span class="nb">sorted</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">contcar</span><span class="o">.</span><span class="n">symbol_set</span><span class="p">))</span>
    <span class="n">search</span><span class="o">=</span> <span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="n">item</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">el_list</span><span class="p">]))</span>
    <span class="c1">#ax1.xlabel(&#39;Increment in K point&#39;)</span>
    <span class="c1">#print &quot;xs,ys&quot;</span>
    <span class="c1">#print xs</span>
    <span class="c1">#print ys</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs1</span><span class="p">,</span><span class="n">ys1</span><span class="p">,</span><span class="s1">&#39;.-&#39;</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="nb">float</span><span class="p">(</span><span class="n">target_ys</span><span class="p">)</span><span class="o">+</span><span class="mf">0.002</span><span class="p">,</span><span class="nb">float</span><span class="p">(</span><span class="n">target_ys</span><span class="p">)</span><span class="o">-</span><span class="mf">0.002</span><span class="p">])</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">get_yaxis</span><span class="p">()</span><span class="o">.</span><span class="n">get_major_formatter</span><span class="p">()</span><span class="o">.</span><span class="n">set_useOffset</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">filename</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;KDen.png&#39;</span><span class="p">)</span>
    <span class="n">k_convg</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">xx</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">yy</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zz</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">plot</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
      <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">plt</span><span class="p">,</span><span class="n">k_convg</span></div>



<div class="viewcode-block" id="IP_optics"><a class="viewcode-back" href="../../../jarvis.tools.html#jarvis.tools.vasp.IP_optics">[docs]</a><span class="k">def</span> <span class="nf">IP_optics</span><span class="p">(</span><span class="n">vrun</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">extra</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">plot</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Optoelectronic properties derived from dielectric function </span>

<span class="sd">    See http://www.wien2k.at/reg_user/textbooks/WIEN2k_lecture-notes_2013/optic_handout.pdf</span>
<span class="sd">    http://www.phys.ufl.edu/~tanner/Wooten-OpticalPropertiesOfSolids-2up.pdf</span>

<span class="sd">    Args:</span>
<span class="sd">       vrun: path to vasprun.xml</span>
<span class="sd">    Reurns:</span>
<span class="sd">          info: dictionary with optoelectronic information</span>
<span class="sd">          energy: energy bins generally 0 to 40 eV</span>
<span class="sd">          real_part: real part of dielectric function</span>
<span class="sd">          imag_part: imaginary part of dielectric function</span>
<span class="sd">          absorption: absorption coefficient in cm^-1</span>
<span class="sd">       </span>
<span class="sd">    TODO: shorten the code with multi-dimensional np array   </span>
<span class="sd">    &quot;&quot;&quot;</span>
          
    <span class="n">info</span><span class="o">=</span><span class="p">{}</span>
    
    <span class="n">storedir</span><span class="o">=</span><span class="n">filename</span>

    <span class="n">run</span> <span class="o">=</span> <span class="n">Vasprun</span><span class="p">(</span><span class="n">vrun</span><span class="p">,</span><span class="n">occu_tol</span><span class="o">=</span><span class="mf">1e-2</span><span class="p">)</span>
    <span class="n">erange</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">en</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">realx</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">imagx</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">absorpx</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">refrx</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">reflx</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">eelsx</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">extcx</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">opt_conx</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">realy</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">imagy</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">absorpy</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">refry</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">refly</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">eelsy</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">extcy</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">opt_cony</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">realz</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">imagz</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">absorpz</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">refrz</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">reflz</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">eelsz</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">extcz</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">opt_conz</span><span class="o">=</span><span class="p">[]</span>
    <span class="n">H</span><span class="o">=</span><span class="mf">4.13566733</span><span class="o">*</span><span class="p">(</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">15</span><span class="p">))</span>
    <span class="c1">#c0=2.99792458</span>
    <span class="n">c0</span><span class="o">=</span><span class="mf">2.99792458</span><span class="o">*</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">erange</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">en</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span>
        <span class="n">realx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">imagx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">ab_valx</span><span class="o">=</span><span class="mf">1.4142</span><span class="o">*</span><span class="p">((</span><span class="nb">float</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">H</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]))))</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">c0</span><span class="p">)</span><span class="o">*</span><span class="mf">100.0</span><span class="p">)))</span>
        <span class="n">absorpx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ab_valx</span><span class="p">)</span>
        <span class="n">refr_valx</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]))))</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mf">1.4142</span><span class="p">)</span>
        <span class="n">refrx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">refr_valx</span><span class="p">)</span>
        <span class="n">eels_valx</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="nb">float</span><span class="p">((</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">eelsx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">eels_valx</span><span class="p">)</span>
        <span class="n">extc_valx</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">]))))</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mf">1.4142</span><span class="p">)</span>
        <span class="n">extcx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">extc_valx</span><span class="p">)</span>
        <span class="n">refl_valx</span><span class="o">=</span><span class="p">((</span><span class="n">refr_valx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">refr_valx</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">extc_valx</span><span class="o">*</span><span class="n">extc_valx</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">refr_valx</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">refr_valx</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">extc_valx</span><span class="o">*</span><span class="n">extc_valx</span><span class="p">)</span>
        <span class="n">reflx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">refl_valx</span><span class="p">)</span>
        <span class="n">opt_valx</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">H</span><span class="p">))</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">opt_conx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">opt_valx</span><span class="p">)</span> 




        <span class="n">realy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">imagy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

        <span class="n">ab_valy</span><span class="o">=</span><span class="mf">1.4142</span><span class="o">*</span><span class="p">((</span><span class="nb">float</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">H</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]))))</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">c0</span><span class="p">)</span><span class="o">*</span><span class="mf">100.0</span><span class="p">)))</span>
        <span class="n">absorpy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ab_valy</span><span class="p">)</span>
        <span class="n">refr_valy</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]))))</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mf">1.4142</span><span class="p">)</span>
        <span class="n">refry</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">refr_valy</span><span class="p">)</span>
        <span class="n">eels_valy</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="nb">float</span><span class="p">((</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]))</span>
        <span class="n">eelsy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">eels_valy</span><span class="p">)</span>
        <span class="n">extc_valy</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">]))))</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mf">1.4142</span><span class="p">)</span>
        <span class="n">extcy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">extc_valy</span><span class="p">)</span>
        <span class="n">refl_valy</span><span class="o">=</span><span class="p">((</span><span class="n">refr_valy</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">refr_valy</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">extc_valy</span><span class="o">*</span><span class="n">extc_valy</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">refr_valy</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">refr_valy</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">extc_valy</span><span class="o">*</span><span class="n">extc_valy</span><span class="p">)</span>
        <span class="n">refly</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">refl_valy</span><span class="p">)</span>
        <span class="n">opt_valy</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">H</span><span class="p">))</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">opt_cony</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">opt_valy</span><span class="p">)</span> 





        <span class="n">realz</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">imagz</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>

        <span class="n">ab_valz</span><span class="o">=</span><span class="mf">1.4142</span><span class="o">*</span><span class="p">((</span><span class="nb">float</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">H</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]))))</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">c0</span><span class="p">)</span><span class="o">*</span><span class="mf">100.0</span><span class="p">)))</span>
        <span class="n">absorpz</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ab_valz</span><span class="p">)</span>
        <span class="n">refr_valz</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]))))</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mf">1.4142</span><span class="p">)</span>
        <span class="n">refrz</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">refr_valz</span><span class="p">)</span>
        <span class="n">eels_valz</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span><span class="o">/</span><span class="nb">float</span><span class="p">((</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]))</span>
        <span class="n">eelsz</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">eels_valz</span><span class="p">)</span>
        <span class="n">extc_valz</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span><span class="o">+</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">]))))</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mf">1.4142</span><span class="p">)</span>
        <span class="n">extcz</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">extc_valz</span><span class="p">)</span>
        <span class="n">refl_valz</span><span class="o">=</span><span class="p">((</span><span class="n">refr_valz</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">refr_valz</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">extc_valz</span><span class="o">*</span><span class="n">extc_valz</span><span class="p">)</span><span class="o">/</span><span class="p">((</span><span class="n">refr_valz</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">refr_valz</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">extc_valz</span><span class="o">*</span><span class="n">extc_valz</span><span class="p">)</span>
        <span class="n">reflz</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">refl_valz</span><span class="p">)</span>
        <span class="n">opt_valz</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">])</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">H</span><span class="p">))</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">run</span><span class="o">.</span><span class="n">dielectric</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">opt_conz</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">opt_valz</span><span class="p">)</span> 
    
    <span class="k">if</span> <span class="n">plot</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
           <span class="c1">#plt.close()</span>
           <span class="n">plt</span> <span class="o">=</span> <span class="n">get_publication_quality_plot</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">en</span><span class="p">,</span><span class="n">realx</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\epsilon_1x$&#39;</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">en</span><span class="p">,</span><span class="n">realy</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\epsilon_1y$&#39;</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">en</span><span class="p">,</span><span class="n">realz</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\epsilon_1z$&#39;</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">26</span><span class="p">})</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">])</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Energy (eV)&#39;</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Dielec. function (Real part)&#39;</span><span class="p">)</span>
           <span class="n">filename</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">storedir</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;Real&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">extra</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;.png&#39;</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

           <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
           <span class="n">plt</span> <span class="o">=</span> <span class="n">get_publication_quality_plot</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">en</span><span class="p">,</span><span class="n">imagx</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\epsilon_2x$&#39;</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">en</span><span class="p">,</span><span class="n">imagy</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\epsilon_2y$&#39;</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">en</span><span class="p">,</span><span class="n">imagz</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\epsilon_2z$&#39;</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Energy (eV)&#39;</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">])</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Dielec. function(Imag part)&#39;</span><span class="p">)</span>
           <span class="n">filename</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">storedir</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;Imag&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">extra</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;.png&#39;</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">26</span><span class="p">})</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>



           <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
           <span class="n">plt</span> <span class="o">=</span> <span class="n">get_publication_quality_plot</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">en</span><span class="p">,</span><span class="n">refrx</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$n_x$&#39;</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">en</span><span class="p">,</span><span class="n">refry</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$n_y$&#39;</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">en</span><span class="p">,</span><span class="n">refrz</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$n_z$&#39;</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">])</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Energy (eV)&#39;</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Refractive index&#39;</span><span class="p">)</span>
           <span class="n">filename</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">storedir</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;Refr&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">extra</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;.png&#39;</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">26</span><span class="p">})</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


           <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
           <span class="n">plt</span> <span class="o">=</span> <span class="n">get_publication_quality_plot</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">en</span><span class="p">,</span><span class="n">extcx</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$k_x$&#39;</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">en</span><span class="p">,</span><span class="n">extcy</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$k_y$&#39;</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">en</span><span class="p">,</span><span class="n">extcz</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$k_z$&#39;</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">])</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Energy (eV)&#39;</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Extinction Coefficient&#39;</span><span class="p">)</span>
           <span class="n">filename</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">storedir</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;Extc&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">extra</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;.png&#39;</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">26</span><span class="p">})</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

           <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
           <span class="n">plt</span> <span class="o">=</span> <span class="n">get_publication_quality_plot</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">en</span><span class="p">,</span><span class="n">absorpx</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\alpha_x$&#39;</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">en</span><span class="p">,</span><span class="n">absorpy</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\alpha_y$&#39;</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">en</span><span class="p">,</span><span class="n">absorpz</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\alpha_z$&#39;</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">])</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Energy (eV)&#39;</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Absorption coefficient&#39;</span><span class="p">)</span>
           <span class="n">filename</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">storedir</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;Absorp&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">extra</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;.png&#39;</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">26</span><span class="p">})</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


           <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
           <span class="n">plt</span> <span class="o">=</span> <span class="n">get_publication_quality_plot</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">en</span><span class="p">,</span><span class="n">eelsx</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$e_x$&#39;</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">en</span><span class="p">,</span><span class="n">eelsy</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$e_y$&#39;</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">en</span><span class="p">,</span><span class="n">eelsz</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$e_z$&#39;</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">])</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Energy (eV)&#39;</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Energy loss spectrum&#39;</span><span class="p">)</span>
           <span class="n">filename</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">storedir</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;ELS&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">extra</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;.png&#39;</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">26</span><span class="p">})</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>



           <span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
           <span class="n">plt</span> <span class="o">=</span> <span class="n">get_publication_quality_plot</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">en</span><span class="p">,</span><span class="n">opt_conx</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\sigma_x$&#39;</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">en</span><span class="p">,</span><span class="n">opt_cony</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\sigma_y$&#39;</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">en</span><span class="p">,</span><span class="n">opt_conz</span><span class="p">,</span><span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$\sigma_z$&#39;</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">])</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Energy (eV)&#39;</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Optical conductivity (Real part)&#39;</span><span class="p">)</span>
           <span class="n">filename</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">storedir</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;Opt_con&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">extra</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;.png&#39;</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="mi">26</span><span class="p">})</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
           <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;absorption&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">absorpx</span><span class="p">,</span><span class="n">absorpy</span><span class="p">,</span><span class="n">absorpz</span><span class="p">]</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;energy&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">en</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;real_part&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">realx</span><span class="p">,</span><span class="n">realy</span><span class="p">,</span><span class="n">realz</span><span class="p">]</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;imag_part&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">imagx</span><span class="p">,</span><span class="n">imagy</span><span class="p">,</span><span class="n">imagz</span><span class="p">]</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;refr_index&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">refrx</span><span class="p">,</span><span class="n">refry</span><span class="p">,</span><span class="n">refrz</span><span class="p">]</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;extinc&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">extcx</span><span class="p">,</span><span class="n">extcy</span><span class="p">,</span><span class="n">extcz</span><span class="p">]</span> 
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;reflectance&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">reflx</span><span class="p">,</span><span class="n">refly</span><span class="p">,</span><span class="n">reflz</span><span class="p">]</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;EELS&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">eelsx</span><span class="p">,</span><span class="n">eelsy</span><span class="p">,</span><span class="n">eelsz</span><span class="p">]</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;opt_conduct&#39;</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">opt_conx</span><span class="p">,</span><span class="n">opt_cony</span><span class="p">,</span><span class="n">opt_conz</span><span class="p">]</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;real_part&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>     
    <span class="k">return</span> <span class="n">info</span></div>

<div class="viewcode-block" id="elastic_props"><a class="viewcode-back" href="../../../jarvis.tools.html#jarvis.tools.vasp.elastic_props">[docs]</a><span class="k">def</span> <span class="nf">elastic_props</span><span class="p">(</span><span class="n">outcar</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">vacuum</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Obtain elastic tensor and calculate related properties</span>

<span class="sd">    Args:</span>
<span class="sd">        outcar: OUTCAR file path</span>
<span class="sd">        vacuum: whether the structure has vaccum such as 2D materials</span>
<span class="sd">        for vacuum structures bulk and shear mod. needs extra attenstion</span>
<span class="sd">        and elastic tensor are in Nm^-1 rather than GPa</span>
<span class="sd">    Returns:</span>
<span class="sd">          info: data for elastic tensor (in string and object representation), bulk, shear modulus, and phonon modes</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">vacuum</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
       <span class="n">contcar</span><span class="o">=</span><span class="n">Structure</span><span class="o">.</span><span class="n">from_file</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">outcar</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;OUTCAR&#39;</span><span class="p">,</span><span class="s1">&#39;POSCAR&#39;</span><span class="p">))</span>
       <span class="n">ratio_c</span><span class="o">=</span><span class="mf">0.1</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">contcar</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">matrix</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]))</span><span class="c1">#*(10**9)*(10**-10) #N/m unit</span>
    <span class="n">el_tens</span><span class="o">=</span><span class="s1">&#39;na&#39;</span>
    <span class="n">KV</span><span class="o">=</span><span class="s1">&#39;na&#39;</span>
    <span class="n">GV</span><span class="o">=</span><span class="s1">&#39;na&#39;</span>
    <span class="n">spin</span><span class="o">=</span><span class="s1">&#39;na&#39;</span>
    <span class="n">info</span><span class="o">=</span><span class="p">{}</span>
    <span class="n">ratio_c</span><span class="o">=</span><span class="mf">1.0</span>
    <span class="n">v</span><span class="o">=</span><span class="nb">open</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">lines</span> <span class="o">=</span> <span class="n">v</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">line</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lines</span><span class="p">):</span>
     <span class="k">if</span> <span class="s2">&quot;TOTAL ELASTIC MODULI (kBar)&quot;</span> <span class="ow">in</span>  <span class="n">line</span><span class="p">:</span>
         <span class="n">c11</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
         <span class="n">c12</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span>
         <span class="n">c13</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">3</span><span class="p">]</span>
         <span class="n">c14</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">4</span><span class="p">]</span>
         <span class="n">c15</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">5</span><span class="p">]</span>
         <span class="n">c16</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">6</span><span class="p">]</span>
         <span class="n">c21</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
         <span class="n">c22</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span>
         <span class="n">c23</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">3</span><span class="p">]</span>
         <span class="n">c24</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">4</span><span class="p">]</span>
         <span class="n">c25</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">5</span><span class="p">]</span>
         <span class="n">c26</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">6</span><span class="p">]</span>
         <span class="n">c31</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
         <span class="n">c32</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span>
         <span class="n">c33</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">3</span><span class="p">]</span>
         <span class="n">c34</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">4</span><span class="p">]</span>
         <span class="n">c35</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">5</span><span class="p">]</span>
         <span class="n">c36</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">6</span><span class="p">]</span>
         <span class="n">c41</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
         <span class="n">c42</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span>
         <span class="n">c43</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">3</span><span class="p">]</span>
         <span class="n">c44</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">4</span><span class="p">]</span>
         <span class="n">c45</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">5</span><span class="p">]</span>
         <span class="n">c46</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">6</span><span class="p">]</span>
         <span class="n">c51</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
         <span class="n">c52</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span>
         <span class="n">c53</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">3</span><span class="p">]</span>
         <span class="n">c54</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">4</span><span class="p">]</span>
         <span class="n">c55</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">5</span><span class="p">]</span>
         <span class="n">c56</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">6</span><span class="p">]</span>
         <span class="n">c61</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
         <span class="n">c62</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">2</span><span class="p">]</span>
         <span class="n">c63</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">3</span><span class="p">]</span>
         <span class="n">c64</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">4</span><span class="p">]</span>
         <span class="n">c65</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">5</span><span class="p">]</span>
         <span class="n">c66</span><span class="o">=</span> <span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">8</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">6</span><span class="p">]</span>
         <span class="n">c11</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">ratio_c</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">c11</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">c12</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">ratio_c</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">c12</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">c13</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">ratio_c</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">c13</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">c14</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">ratio_c</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">c14</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">c15</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">ratio_c</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">c15</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">c16</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">ratio_c</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">c16</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">c21</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">ratio_c</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">c21</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">c22</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">ratio_c</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">c22</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">c23</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">ratio_c</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">c23</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">c24</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">ratio_c</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">c24</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">c25</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">ratio_c</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">c25</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">c26</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="n">ratio_c</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">c26</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">c31</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">c31</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">c32</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">c32</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">c33</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">c33</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">c34</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">c34</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">c35</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">c35</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">c36</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">c36</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">c41</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">c41</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">c42</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">c42</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">c43</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">c43</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">c44</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">c44</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">c45</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">c45</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">c46</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">c46</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">c51</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">c51</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">c52</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">c52</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">c53</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">c53</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">c54</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">c54</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">c55</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">c55</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">c56</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">c56</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">c61</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">c61</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">c62</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">c62</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">c63</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">c63</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">c64</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">c64</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">c65</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">c65</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">c66</span><span class="o">=</span><span class="nb">round</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">c66</span><span class="p">)</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
         <span class="n">KV</span><span class="o">=</span><span class="nb">float</span><span class="p">((</span><span class="n">c11</span><span class="o">+</span><span class="n">c22</span><span class="o">+</span><span class="n">c33</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">c12</span><span class="o">+</span><span class="n">c23</span><span class="o">+</span><span class="n">c31</span><span class="p">))</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
         <span class="n">GV</span><span class="o">=</span><span class="nb">float</span><span class="p">((</span><span class="n">c11</span><span class="o">+</span><span class="n">c22</span><span class="o">+</span><span class="n">c33</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">c12</span><span class="o">+</span><span class="n">c23</span><span class="o">+</span><span class="n">c31</span><span class="p">)</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="n">c44</span><span class="o">+</span><span class="n">c55</span><span class="o">+</span><span class="n">c66</span><span class="p">))</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span>
         <span class="n">KV</span><span class="o">=</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">KV</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
         <span class="n">GV</span><span class="o">=</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">GV</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
         <span class="k">break</span>
    <span class="n">v</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

    <span class="c1">#Convenient string representation for storage</span>

    <span class="n">el_tens</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">c11</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c12</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c13</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c14</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c15</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c16</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c21</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c22</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c23</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c24</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c25</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c26</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c31</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c32</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c33</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c34</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c35</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c36</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c41</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c42</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c43</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c44</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c45</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c46</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c51</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c52</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c53</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c54</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c55</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c56</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c61</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c62</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c63</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c64</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c65</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">)</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">c66</span><span class="p">)</span>

    <span class="n">cij</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">elast</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">el_tens</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">),</span><span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float&#39;</span><span class="p">)</span>
    <span class="n">count</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
      <span class="k">for</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
        <span class="n">cij</span><span class="p">[</span><span class="n">ii</span><span class="p">][</span><span class="n">jj</span><span class="p">]</span><span class="o">=</span><span class="n">elast</span><span class="p">[</span><span class="n">count</span><span class="p">]</span>
    <span class="n">el_tens2</span><span class="o">=</span><span class="n">ElasticTensor</span><span class="o">.</span><span class="n">from_voigt</span><span class="p">(</span><span class="n">cij</span><span class="p">)</span>

    <span class="n">modes</span><span class="o">=</span><span class="p">[]</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;cm-1&#39;</span> <span class="ow">in</span> <span class="n">i</span> <span class="ow">and</span> <span class="s1">&#39;meV&#39;</span> <span class="ow">in</span> <span class="n">i</span><span class="p">:</span>
         <span class="n">mod</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">7</span><span class="p">])</span>
         <span class="k">if</span> <span class="n">mod</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">modes</span><span class="p">:</span>
            <span class="n">modes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">mod</span><span class="p">))</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">pass</span>

    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;el_tens_str&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">el_tens</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;el_tens_obj&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">el_tens2</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;KV&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">KV</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;GV&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">GV</span>
    <span class="n">info</span><span class="p">[</span><span class="s1">&#39;modes&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">modes</span>

    <span class="k">return</span> <span class="n">info</span></div>

<div class="viewcode-block" id="magnetic_moment"><a class="viewcode-back" href="../../../jarvis.tools.html#jarvis.tools.vasp.magnetic_moment">[docs]</a><span class="k">def</span> <span class="nf">magnetic_moment</span><span class="p">(</span><span class="n">oszicar</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Obtain total orbital magnetic moment</span>
<span class="sd">    Magnetic moment info is found in both OSZICAR and OUTCAR</span>
<span class="sd">    We prefer OSZICAR values</span>

<span class="sd">    Args:</span>
<span class="sd">        oszicar: path to OSZICAR</span>
<span class="sd">    Returns:</span>
<span class="sd">          magmom: orbital magnetic moment in Bohr-magneton</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">magmom</span><span class="o">=</span><span class="n">Oszicar</span><span class="p">(</span><span class="n">oszicar</span><span class="p">)</span><span class="o">.</span><span class="n">ionic_steps</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;mag&#39;</span><span class="p">]</span>
    <span class="c1">#magmom_out=out.total_mag #for outcar</span>
    <span class="k">return</span> <span class="n">magmom</span></div>

<div class="viewcode-block" id="get_area"><a class="viewcode-back" href="../../../jarvis.tools.html#jarvis.tools.vasp.get_area">[docs]</a><span class="k">def</span> <span class="nf">get_area</span><span class="p">(</span><span class="n">strt</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get area of a Structure object along z-direction</span>

<span class="sd">    Args: </span>
<span class="sd">        strt: Structure object</span>
<span class="sd">    Returns:</span>
<span class="sd">           area</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">m</span><span class="o">=</span><span class="n">strt</span><span class="o">.</span><span class="n">lattice</span><span class="o">.</span><span class="n">matrix</span>
    <span class="n">area</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cross</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">m</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
    <span class="k">return</span> <span class="n">area</span></div>

<div class="viewcode-block" id="get_spacegroup"><a class="viewcode-back" href="../../../jarvis.tools.html#jarvis.tools.vasp.get_spacegroup">[docs]</a><span class="k">def</span> <span class="nf">get_spacegroup</span><span class="p">(</span><span class="n">strt</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get spacegroup of a Structure pbject</span>
<span class="sd">    </span>
<span class="sd">    Args:</span>
<span class="sd">        strt: Structure object</span>
<span class="sd">    Returns:</span>
<span class="sd">           num: spacegroup number</span>
<span class="sd">           symb: spacegroup symbol</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">finder</span> <span class="o">=</span> <span class="n">SpacegroupAnalyzer</span><span class="p">(</span><span class="n">strt</span><span class="p">)</span>
    <span class="n">num</span><span class="o">=</span><span class="n">finder</span><span class="o">.</span><span class="n">get_space_group_number</span><span class="p">()</span>
    <span class="n">symb</span><span class="o">=</span><span class="n">finder</span><span class="o">.</span><span class="n">get_space_group_symbol</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">num</span><span class="p">,</span><span class="n">symb</span></div>


<span class="c1">#vrun=&#39;../vasp/examples/SiOptb88/MAIN-OPTICS-bulk@mp_149/vasprun.xml&#39;</span>
<span class="c1">#out=&#39;../vasp/examples/SiOptb88/MAIN-ELASTIC-bulk@mp_149/OUTCAR&#39;</span>
<span class="c1">#osz=&#39;../vasp/examples/SiOptb88/MAIN-RELAX-bulk@mp_149/OSZICAR&#39;</span>
<span class="c1">#m=magnetic_moment(osz)</span>
<span class="c1">#print (m)</span>
<span class="c1">#info=elastic_props(out)</span>
<span class="c1">#print (info[&#39;KV&#39;])</span>
<span class="c1">#op=IP_optics(vrun,plot=True)</span>
<span class="c1">##op[&#39;real_part&#39;][0][0]</span>
<span class="c1">#print (op)</span>
<span class="c1">#plot_kp_convergence()</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">jarvis-tools v2018.10.22 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Kamal Choudhary.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.1.
    </div>
  </body>
</html>